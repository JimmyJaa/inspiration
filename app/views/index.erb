<!DOCTYPE html>
<html class="no-js" lang="en" >
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />

    <title>Nat's Inspiration</title>

    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/application.css" />

    <script src="js/vendor/custom.modernizr.js"></script>
  </head>
  <body>
    <div class="small-12 columns">
      <hr />
      <p>This is a simple <a href="https://en.wikipedia.org/wiki/Mood_board">mood board</a> for Nat, pulled from <a href="http://calvin166.deviantart.com/favourites/">his DeviantArt favorites</a>. See the <a href="http://github.com/icco/inspiration">source</a>.
      <hr />
    </div>

    <div id="container" class="large-12 columns">
      <% @images.each do |url| %>
        <div class="embed" style="display: none" data-embed="<%= url %>"></div>
      <% end %>
    </div>

    <div class="small-12 columns">
      <hr />
    </div>

    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/jquery.isotope.min.js"></script>
    <script src="js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      $('#container').isotope({ itemSelector : '.item' });
      $('#container').isotope('shuffle');

      $('.embed').each(function(index, value) {
        var url = $(value).data('embed');
        var oembed_url = 'http://backend.deviantart.com/oembed?url=' + encodeURIComponent(url) + '&format=jsonp&callback=?';
        $.getJSON(oembed_url, function(data) {
          images = data;
        }).complete(function() {
          var a = $('<a>');
          var img = $('<img>');
          var div = $('<div class="item">');

          img.attr('src', images.thumbnail_url);
          img.attr('alt', images.title);

          a.attr('href', url);
          a.attr('title', images.title);

          a.append(img);
          div.append(a);

          $('#container').imagesLoaded(function(){ $('#container').isotope('insert', div); });
        });
      });
    </script>
  </body>
</html>
